# Animal Detector GUI

## 概要

このツールは、10秒ごとに撮影した画像から動物（背景より暗い領域）を自動検出し、重心位置・長軸・短軸・円形度などの特徴量を測定します。昼と夜で画像の明るさが大きく異なる場合も、代表画像を選ぶことで最適な閾値を簡単に設定できます。

## 必要な環境
- Python 3.8以降
- pip

### 必要なライブラリ
```
pip install opencv-python numpy pandas Pillow
```

**注意**: tkinterは使用していますが、Pythonの標準ライブラリなので追加インストールは不要です。

## 使い方

1. 本ツール（animal_detector_gui.py）をダウンロードし、同じフォルダに画像を用意してください。
2. コマンドプロンプトでスクリプトを起動します：
   ```
   python animal_detector_gui.py
   ```
3. GUI画面が表示されます。以下の手順で設定してください：
   - **画像フォルダ**: 解析したい画像が入っているフォルダを選択
   - **昼の代表画像**: 明るい時間帯の代表的な画像を選択
   - **夜の代表画像**: 暗い時間帯の代表的な画像を選択
   - **昼の閾値**: 昼間用の二値化閾値（デフォルト: 120）
   - **夜の閾値**: 夜間用の二値化閾値（デフォルト: 40）
   - **最小面積**: 検出対象の最小面積（デフォルト: 100）
   - **最大面積**: 検出対象の最大面積（デフォルト: 10000）

4. **「プレビュー更新」ボタン**を押すと、右側のタブで昼・夜の代表画像に対する検出結果を確認できます
5. パラメータを調整しながらプレビューで検出結果を確認し、適切な設定を見つけてください
6. 「解析開始」ボタンを押すと、全画像を自動判定し、動物の特徴量をCSVに保存します
7. 解析結果画像（検出領域・重心などを重ねた画像）も同じフォルダに保存されます。

## 特徴
- **自動昼夜判定**: 代表画像から自動的に昼夜を判定する閾値を設定
- **リアルタイム進捗表示**: 解析の進行状況をGUIで確認可能
- **エラーハンドリング**: 適切なエラーメッセージとバリデーション
- **マルチスレッド処理**: GUIをブロックせずに解析を実行

## 出力
- `results.csv`：各画像ごとの特徴量一覧（重心x,y、長軸、短軸、円形度、面積、昼夜判定）
- `output/`：検出結果を重ねた画像（緑の輪郭線と赤い重心点）

## トラブルシューティング
- 動物が検出されない場合は、閾値を調整してください
- エラーが発生する場合は、画像ファイルの形式（jpg, png, bmp）を確認してください
- 処理が重い場合は、ノイズ除去面積閾値を大きくしてください

## ライセンス
MIT License
